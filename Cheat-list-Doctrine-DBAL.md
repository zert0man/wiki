# Краткий справочник по функциям Doctrine DBAL

[Ссылка на документацию по Doctrine DBAL](http://doctrine-dbal.readthedocs.org/en/latest/reference/data-retrieval-and-manipulation.html)

[Doctrine\DBAL\Connection API](http://www.doctrine-project.org/api/dbal/2.1/class-Doctrine.DBAL.Connection.html)

## Функции для выборки из таблицы

Если вам необходима более сложная функциональность команд изменения, используйте функцию `executeQuery()`.

### fetchAll

```
fetchAll( string $sql, array $params = array() )
```

Выполняет запрос на выборку данных и возвращает ассоциативный массив с результатом.

Параметры:
- `$sql` - SQL-запрос, как правило, `select`.
- `$params` - параметры запроса в виде массива.

Например:

```
 $students = $conn->fetchAll('select * from students');
```

Результат будет массивом:

```
array(4) {
  [0]=>
  array(2) {
    ["id"]=>
    string(1) "1"
    ["name"]=>
    string(12) "Иванов"
  }
  [1]=>
  array(2) {
    ["id"]=>
    string(1) "4"
    ["name"]=>
    string(14) "Иванова"
  }
  [2]=>
  array(2) {
    ["id"]=>
    string(1) "3"
    ["name"]=>
    string(12) "Петров"
  }
  [3]=>
  array(2) {
    ["id"]=>
    string(1) "2"
    ["name"]=>
    string(16) "Сидорова"
  }
}
```

Пример с параметром:

```
 $students = $conn->fetchAll('select * from students where id > ?',array(2));
```

Результат на тех же данных:

```
array(2) {
  [0]=>
  array(2) {
    ["id"]=>
    string(1) "4"
    ["name"]=>
    string(14) "Иванова"
  }
  [1]=>
  array(2) {
    ["id"]=>
    string(1) "3"
    ["name"]=>
    string(12) "Петров"
  }
}
```
## Функции для изменения в таблице

Если вам необходима более сложная функциональность команд изменения, используйте функцию `executeUpdate()`.

### insert

```
insert( string $tableName, array $data, array $types = array() )
```

Добавляет строку в таблицу. Возвращает количество добавленных строк.

Параметры:
- `$tableName` - имя таблицы, которую будем обновлять.
- `$data` - данные, которые надо записать в таблицу; представляет собой ассоциативный массив, где ключи - названия полей, значения - данные, которые надо записать в эти поля.
- `$types` - список типов, в которые надо преобразовать данные (если это необходимо).


### delete

``
delete( string $tableName, array $identifier )
```

Удаляет из таблицы данные, соответстующие описанным условиям.

Параметры:
- `$tableName` - имя таблицы, которую будем обновлять.
- `$identifier` - описание критерия, по которому определяются редактируемые записи; это тоже ассоциативный массив, где ключами являются имена полей, а значением - данные. На основе этого критерия формируются условия для `WHERE`. Например, идентификатор конкретной записи: `array('id' => 4)` или, например, все записи, у которых установлен флаг в поле `moderated`: `array('moderated' => 1)`.

### update
 	
```
update( string $tableName, array $data, array $identifier, array $types = array() )
```

Выполняет операцию обновления записи в таблице. Возвращает количество измененных записей.

Параметры:
- `$tableName` - имя таблицы, которую будем обновлять.
- `$data` - данные, которые надо записать в таблицу; представляет собой ассоциативный массив, где ключи - названия полей, значения - данные, которые надо записать в эти поля.
- `$identifier` - описание критерия, по которому определяются редактируемые записи; это тоже ассоциативный массив того же вида, что и `$data`, на основе которого формируются условия для `WHERE`. Например, идентификатор конкретной записи: `array('id' => 4)` или, например, все записи, у которых установлен флаг в поле `moderated`: `array('moderated' => 1)`.
- `$types` - список типов, в которые надо преобразовать данные (если это необходимо).


